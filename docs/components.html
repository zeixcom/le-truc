<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Components ‚Äì Le Truc Docs</title>
		<meta name="description" content="Anatomy, lifecycle, signals, effects" />
		<link
			rel="preload"
			href="./assets/main.css?v=mlqcj7ru"
			as="style"
		/>
		<link
			rel="modulepreload"
			href="./assets/main.js?v=mlqcj7ru"
		/>
		<link
			rel="stylesheet"
			href="./assets/main.css?v=mlqcj7ru"
		/>
		<script
			type="module"
			src="./assets/main.js?v=mlqcj7ru"
		></script>
	</head>

	<body class="">
		<context-router>
			<header class="content-grid">
				<a href="#main" class="skiplink visually-hidden">
					Skip to main content
				</a>
				<h1 class="content">Le Truc Docs <small>Version 0.16.0</small></h1>
				<section-menu>
		<nav>
			<h2 class="visually-hidden">Main Menu</h2>
			<ol>
				<li>
		<a href="index.html">
			<span class="icon">üìñ</span>
			<strong>Introduction</strong>
			<small>Overview and key benefits of Le Truc</small>
		</a>
	</li><li>
		<a href="getting-started.html">
			<span class="icon">üöÄ</span>
			<strong>Getting Started</strong>
			<small>Installation, setup, and first steps</small>
		</a>
	</li><li>
		<a href="components.html">
			<span class="icon">üèóÔ∏è</span>
			<strong>Components</strong>
			<small>Anatomy, lifecycle, signals, effects</small>
		</a>
	</li><li>
		<a href="styling.html">
			<span class="icon">üé®</span>
			<strong>Styling</strong>
			<small>Scoped styles, CSS custom properties</small>
		</a>
	</li><li>
		<a href="data-flow.html">
			<span class="icon">üîÑ</span>
			<strong>Data Flow</strong>
			<small>Passing state, events, context</small>
		</a>
	</li><li>
		<a href="examples.html">
			<span class="icon">üçΩÔ∏è</span>
			<strong>Examples</strong>
			<small>Common use cases and demos</small>
		</a>
	</li><li>
		<a href="about.html">
			<span class="icon">ü§ù</span>
			<strong>About</strong>
			<small>License, versioning, getting involved</small>
		</a>
	</li>
			</ol>
		</nav>
	</section-menu>
				<card-callout class="content danger" hidden>
					<p class="error" role="alert" aria-live="assertive"></p>
				</card-callout>
			</header>

			<main id="main" class="content-grid"><section-hero><h1 id="-components"><a name="-components" class="anchor" href="#-components"><span class="permalink">üîó</span><span class="title">üèóÔ∏è Components</span></a></h1><div class="hero-layout"><div class="lead"><p><strong>Create lightweight, self-contained Web Components with built-in reactivity</strong>. Le Truc lets you define custom elements that manage state efficiently, update the DOM automatically, and enhance server-rendered pages without an SPA framework.</p></div><module-toc>
		<nav>
			<h2>On This Page</h2>
			<ol>
				<li>
		<a href="#defining-a-component">Defining a Component</a>
	</li><li>
		<a href="#component-lifecycle">Component Lifecycle</a>
	</li><li>
		<a href="#managing-state-with-signals">Managing State with Signals</a>
	</li><li>
		<a href="#selecting-elements">Selecting Elements</a>
	</li><li>
		<a href="#adding-event-listeners">Adding Event Listeners</a>
	</li><li>
		<a href="#synchronizing-state-with-effects">Synchronizing State with Effects</a>
	</li>
			</ol>
		</nav>
	</module-toc></div></section-hero><section><h2 id="defining-a-component"><a name="defining-a-component" class="anchor" href="#defining-a-component"><span class="permalink">üîó</span><span class="title">Defining a Component</span></a></h2><p>Le Truc builds on <strong>Web Components</strong>, extending <code>HTMLElement</code> to provide <strong>built-in state management and reactive updates</strong>.</p><p>Le Truc creates components using the <code>defineComponent()</code> function:</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!" collapsed=""><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'my-component'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {},                    </span><span style="color:#88846F">// Reactive properties</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">first</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">all</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#88846F">    // Select descendant elements</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#FD971F;font-style:italic">  ui</span><span style="color:#66D9EF;font-style:italic"> =></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#88846F">    // Component setup: return effects</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><p>Every Le Truc component must be registered with a valid custom element tag name (two or more words joined with <code>-</code>) as the first parameter.</p><h3 id="using-the-custom-element-in-html"><a name="using-the-custom-element-in-html" class="anchor" href="#using-the-custom-element-in-html"><span class="permalink">üîó</span><span class="title">Using the Custom Element in HTML</span></a></h3><p>Once registered, the component can be used like any native HTML element:</p><module-codeblock language="html" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><p class="meta"><span class="language">html</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#F8F8F2">&#x3C;</span><span style="color:#F92672">my-component</span><span style="color:#F8F8F2">>Content goes here&#x3C;/</span><span style="color:#F92672">my-component</span><span style="color:#F8F8F2">></span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button></module-codeblock><h3 id="anatomy-of-a-component"><a name="anatomy-of-a-component" class="anchor" href="#anatomy-of-a-component"><span class="permalink">üîó</span><span class="title">Anatomy of a Component</span></a></h3><p>Let's examine a complete component example to understand how Le Truc works:</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!" collapsed=""><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'basic-hello'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {</span></span>
<span class="line"><span style="color:#F8F8F2">    name: </span><span style="color:#A6E22E">asString</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">ui</span><span style="color:#66D9EF;font-style:italic"> =></span><span style="color:#F8F8F2"> ui.output.textContent),</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">first</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#F8F8F2">    input: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'input'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'Needed to enter the name.'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">    output: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'output'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'Needed to display the name.'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">host</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">input</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    const</span><span style="color:#F8F8F2"> fallback </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> host.name</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">      input: </span><span style="color:#A6E22E">on</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'input'</span><span style="color:#F8F8F2">, () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">        host.name </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> input.value </span><span style="color:#F92672">||</span><span style="color:#F8F8F2"> fallback</span></span>
<span class="line"><span style="color:#F8F8F2">      }),</span></span>
<span class="line"><span style="color:#F8F8F2">      output: </span><span style="color:#A6E22E">setText</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'name'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><h4 id="reactive-properties"><a name="reactive-properties" class="anchor" href="#reactive-properties"><span class="title">Reactive Properties</span><span class="permalink">#</span></a></h4><module-codeblock language="js"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">  name: </span><span style="color:#A6E22E">asString</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">ui</span><span style="color:#66D9EF;font-style:italic"> =></span><span style="color:#F8F8F2"> ui.output.textContent),</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button></module-codeblock><p>This creates a reactive property called <code>name</code>:</p><ul><li><code>asString()</code> observes the attribute <code>name</code> and assigns its value as a string to the <code>name</code> property</li><li><code>ui =&gt; ...</code> is an instruction how to get the fallback value in the DOM if there is no name attribute</li><li>Le Truc automatically reads &quot;World&quot; from the <code>&lt;output&gt;</code> element as the initial value</li><li>When <code>name</code> changes, any effects that depend on it automatically update</li></ul><h4 id="select-function"><a name="select-function" class="anchor" href="#select-function"><span class="title">Select Function</span><span class="permalink">#</span></a></h4><p>The select function is used to find descendant elements within the component's DOM:</p><module-codeblock language="js"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#F8F8F2">({ </span><span style="color:#FD971F;font-style:italic">first</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#F8F8F2">  input: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'input'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'Needed to enter the name.'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">  output: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'output'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'Needed to display the name.'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">}),</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button></module-codeblock><p>The select function must return a record of the selected elements, commonly called <code>ui</code>. Both property initializers and the setup function have access to this object, so elements are queried once and shared everywhere.</p><p>This is a separate parameter from the setup function for a reason: Le Truc initializes components in three phases ‚Äî <strong>select elements ‚Üí initialize properties ‚Üí run effects</strong>. Some property initializers need to read from the DOM (e.g. <code>read(ui =&gt; ui.input.value, asInteger())</code>), so the elements must be queried first. And some queried elements may be custom elements that haven't been upgraded yet, so Le Truc waits for their definitions before running effects.</p><p>In the above example, the helper function <code>first()</code> is used to find the first descendant matching a selector. Also available is <code>all()</code> which returns a <code>Memo&lt;E[]&gt;</code> ‚Äî a lazily observed collection that dynamically updates when matching elements are added or removed from the DOM. Both helper functions take a selector string and an optional error message explaining why the element is required for proper functioning of the component:</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#88846F">// Optional element ‚Äî effects for this key are skipped if not found</span></span>
<span class="line"><span style="color:#F8F8F2">input: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'input'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">// Required element ‚Äî throws MissingElementError with your message if not found</span></span>
<span class="line"><span style="color:#F8F8F2">input: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'input'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'Needed to enter the name.'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button></module-codeblock><h4 id="setup-function"><a name="setup-function" class="anchor" href="#setup-function"><span class="permalink">üîó</span><span class="title">Setup Function</span></a></h4><p>The setup function must return a record with an array of effects for properties of the <code>ui</code> object that is passed in. The additional <code>host</code> key of the <code>ui</code> object holds the component element itself.</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#F8F8F2">({ </span><span style="color:#FD971F;font-style:italic">host</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">input</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">  const</span><span style="color:#F8F8F2"> fallback </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> host.name</span></span>
<span class="line"><span style="color:#F92672">  return</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">    input: </span><span style="color:#A6E22E">on</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'input'</span><span style="color:#F8F8F2">, () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">      host.name </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> input.value </span><span style="color:#F92672">||</span><span style="color:#F8F8F2"> fallback</span></span>
<span class="line"><span style="color:#F8F8F2">    }),</span></span>
<span class="line"><span style="color:#F8F8F2">    output: </span><span style="color:#A6E22E">setText</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'name'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">},</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button></module-codeblock><p>Effects define <strong>component behaviors</strong>:</p><ul><li><code>input: on('input', ...)</code> adds an event listener to the <code>&lt;input&gt;</code> element</li><li><code>output: setText('name')</code> keeps its text in sync with the <code>name</code> property</li></ul><p>Characteristics of effects:</p><ul><li>Effects run when the component is added to the page</li><li>Effects rerun when their dependencies change</li><li>Effects may return a cleanup function to be executed when the target element or the component is removed from the page</li></ul><p>The bundled effects <code>on()</code> and <code>setText()</code> in this case are partially applied functions that connect to component properties and the target element and return the appropriate cleanup function.</p></section><section class="" id="undefined"><h2 id="component-lifecycle"><a name="component-lifecycle" class="anchor" href="#component-lifecycle"><span class="title">Component Lifecycle</span><span class="permalink">#</span></a></h2><p>Le Truc manages the <strong>Web Component lifecycle</strong> from creation to removal. Here's what happens.</p><h3 id="connected-to-the-dom"><a name="connected-to-the-dom" class="anchor" href="#connected-to-the-dom"><span class="title">Connected to the DOM</span><span class="permalink">#</span></a></h3><p>In the <code>connectedCallback()</code> reactive properties are initialized. You pass a second argument to the <code>defineComponent()</code> function to define initial values for <strong>component states</strong>.</p><module-codeblock language="js" collapsed="true"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'my-component'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {</span></span>
<span class="line"><span style="color:#F8F8F2">    count: </span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">, </span><span style="color:#88846F">// Initial value of "count" signal</span></span>
<span class="line"><span style="color:#F8F8F2">    value: </span><span style="color:#A6E22E">asInteger</span><span style="color:#F8F8F2">(</span><span style="color:#AE81FF">5</span><span style="color:#F8F8F2">), </span><span style="color:#88846F">// Parse "value" attribute as integer defaulting to 5</span></span>
<span class="line"><span style="color:#A6E22E">    isEven</span><span style="color:#F8F8F2">: </span><span style="color:#FD971F;font-style:italic">ui</span><span style="color:#66D9EF;font-style:italic"> =></span><span style="color:#F8F8F2"> () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F92672"> !</span><span style="color:#F8F8F2">(ui.host.count </span><span style="color:#F92672">%</span><span style="color:#AE81FF"> 2</span><span style="color:#F8F8F2">), </span><span style="color:#88846F">// Computed signal based on "count" signal</span></span>
<span class="line"><span style="color:#F8F8F2">    name: </span><span style="color:#A6E22E">requestContext</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'display-name'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'World'</span><span style="color:#F8F8F2">), </span><span style="color:#88846F">// Consume "display-name" signal from closest context provider</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">  () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#88846F">    // Component UI</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#FD971F;font-style:italic">  ui</span><span style="color:#66D9EF;font-style:italic"> =></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#88846F">    // Component setup</span></span>
<span class="line"><span style="color:#F8F8F2">  })</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><p>In this example you see all three ways to define a reactive property:</p><ul><li>A <strong>static initial value</strong> creates a <code>State</code> signal with the initial value</li><li>An <strong>attribute parser</strong> creates a <code>State</code> signal may from the attribute or fallback value, updating the state whenever the attribute changes</li><li>An <strong>initializer</strong> function that creates a <code>State</code> or a <code>Computed</code> signal depending on the return type of the function. If the function returns a value, it creates a <code>State</code> signal. If the function returns a function, it creates a <code>Computed</code> signal. Initializer functions have access to the component's <code>ui</code> object, allowing them to create signals based on the component's state or descendant elements.</li></ul><h3 id="disconnected-from-the-dom"><a name="disconnected-from-the-dom" class="anchor" href="#disconnected-from-the-dom"><span class="permalink">üîó</span><span class="title">Disconnected from the DOM</span></a></h3><p>In the <code>disconnectedCallback()</code> Le Truc runs all cleanup functions returned by effects during the setup phase in <code>connectedCallback()</code>. This will remove all event listeners and unsubscribe all signals the component is subscribed to, so you don't need to worry about memory leaks.</p><p>If you added <strong>event listeners</strong> outside the scope of your component or <strong>subscribed manually to external APIs</strong> in a custom effect, you need to return a cleanup function:</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!" collapsed=""><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'my-component'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {},</span></span>
<span class="line"><span style="color:#F8F8F2">  () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({}),</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">host</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#A6E22E">    host</span><span style="color:#F8F8F2">: () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#88846F">      // Setup logic</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">      const</span><span style="color:#F8F8F2"> observer </span><span style="color:#F92672">=</span><span style="color:#F92672"> new</span><span style="color:#A6E22E"> IntersectionObserver</span><span style="color:#F8F8F2">(([</span><span style="color:#FD971F;font-style:italic">entry</span><span style="color:#F8F8F2">]) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#88846F">        // Do something</span></span>
<span class="line"><span style="color:#F8F8F2">      })</span></span>
<span class="line"><span style="color:#F8F8F2">      observer.</span><span style="color:#A6E22E">observe</span><span style="color:#F8F8F2">(host)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F">      // Cleanup logic</span></span>
<span class="line"><span style="color:#F92672">      return</span><span style="color:#F8F8F2"> () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> observer.</span><span style="color:#A6E22E">disconnect</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">    },</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><h2 id="managing-state-with-signals"><a name="managing-state-with-signals" class="anchor" href="#managing-state-with-signals"><span class="permalink">üîó</span><span class="title">Managing State with Signals</span></a></h2><p>Le Truc manages state using <strong>signals</strong>, which are atomic reactive states that trigger updates when they change. We use regular properties for public component states:</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#F8F8F2">console.</span><span style="color:#A6E22E">log</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'count'</span><span style="color:#F92672"> in</span><span style="color:#F8F8F2"> el) </span><span style="color:#88846F">// Check if the signal exists</span></span>
<span class="line"><span style="color:#F8F8F2">console.</span><span style="color:#A6E22E">log</span><span style="color:#F8F8F2">(el.count) </span><span style="color:#88846F">// Read the signal value</span></span>
<span class="line"><span style="color:#F8F8F2">el.count </span><span style="color:#F92672">=</span><span style="color:#AE81FF"> 42</span><span style="color:#88846F"> // Update the signal value</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button></module-codeblock><h3 id="characteristics-and-special-values"><a name="characteristics-and-special-values" class="anchor" href="#characteristics-and-special-values"><span class="permalink">üîó</span><span class="title">Characteristics and Special Values</span></a></h3><p>Signals in Le Truc are of a <strong>static type</strong> and <strong>non-nullable</strong>. This allows to <strong>simplify the logic</strong> as you will never have to check the type or perform null-checks.</p><ul><li>If you use <strong>TypeScript</strong> (recommended), <strong>you will be warned</strong> that <code>null</code> or <code>undefined</code> cannot be assigned to a signal or if you try to assign a value of a wrong type.</li><li>If you use vanilla <strong>JavaScript</strong> without a build step, setting a signal to <code>null</code> or <code>undefined</code> <strong>will throw a <code>NullishSignalValueError</code></strong>. However, strict type checking is not enforced at runtime.</li></ul><p>Because of the <strong>non-nullable nature of signals</strong> in Le Truc, there is a special value that can be assigned to any signal type:</p><ul><li><strong><code>RESET</code></strong>: Will <strong>reset to the server-rendered version</strong> that was there before Le Truc took control. This is what you want to do most of the times when a signal lacks a specific value.</li></ul><p>To unset an attribute or style property in effects, return <code>null</code> from the reactive function. This signals to the effect system that the value should be removed.</p><h3 id="initializing-state-from-attributes"><a name="initializing-state-from-attributes" class="anchor" href="#initializing-state-from-attributes"><span class="permalink">üîó</span><span class="title">Initializing State from Attributes</span></a></h3><p>The standard way to set initial state in Le Truc is via <strong>server-rendered attributes</strong> on the component that needs it. No props drilling as in other frameworks. Le Trucs provides some bundled attribute parsers to convert attribute values to the desired type. And you can also define your own custom parsers.</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!" collapsed=""><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'my-component'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {</span></span>
<span class="line"><span style="color:#F8F8F2">    count: </span><span style="color:#A6E22E">asInteger</span><span style="color:#F8F8F2">(), </span><span style="color:#88846F">// Bundled parser: Convert '42' -> 42</span></span>
<span class="line"><span style="color:#A6E22E">    date</span><span style="color:#F8F8F2">: (</span><span style="color:#FD971F;font-style:italic">_</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">v</span><span style="color:#F8F8F2">) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F92672"> new</span><span style="color:#A6E22E"> Date</span><span style="color:#F8F8F2">(v), </span><span style="color:#88846F">// Custom parser: '2025-12-12' -> Date object</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">  () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#88846F">    // Component UI</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#F8F8F2">  () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#88846F">    // Component setup</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><card-callout class="caution"><p><strong>Careful</strong>: Attributes <strong>may not be present</strong> on the element or <strong>parsing to the desired type may fail</strong>. To ensure <strong>non-nullability</strong> of signals, Le Truc falls back to neutral defaults if no fallback value is provided:</p><ul><li><code>&quot;&quot;</code> (empty string) for <code>string</code></li><li><code>0</code> for <code>number</code></li><li><code>{}</code> (empty object) for objects of any kind</li></ul></card-callout><h3 id="bundled-attribute-parsers"><a name="bundled-attribute-parsers" class="anchor" href="#bundled-attribute-parsers"><span class="title">Bundled Attribute Parsers</span><span class="permalink">#</span></a></h3><p>Le Truc provides several built-in parsers for common attribute types. See the  in the API reference for detailed descriptions and usage examples.</p></section><section class="" id="undefined"><h2 id="selecting-elements"><a name="selecting-elements" class="anchor" href="#selecting-elements"><span class="title">Selecting Elements</span><span class="permalink">#</span></a></h2><p>Use the provided selector utilities to find descendant elements within your component:</p><h3 id="first"><a name="first" class="anchor" href="#first"><span class="title">first()</span><span class="permalink">#</span></a></h3><p>Selects the first matching element:</p><module-codeblock language="js" collapsed="true"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'basic-counter'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {</span></span>
<span class="line"><span style="color:#88846F">    // Initialize properties</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">first</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#F8F8F2">    increment: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">      'button'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E6DB74">      'Add a native button element to increment the count.'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    ),</span></span>
<span class="line"><span style="color:#F8F8F2">    count: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'span'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'Add a span to display the count.'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#FD971F;font-style:italic">  ui</span><span style="color:#66D9EF;font-style:italic"> =></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#88846F">    // Component setup</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><h3 id="all"><a name="all" class="anchor" href="#all"><span class="title">all()</span><span class="permalink">#</span></a></h3><p>Selects all matching elements:</p><module-codeblock language="js" collapsed="true"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'module-tabgroup'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {</span></span>
<span class="line"><span style="color:#88846F">    // Initialize properties</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">all</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#F8F8F2">    tabs: </span><span style="color:#A6E22E">all</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">      'button[role="tab"]'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E6DB74">      'At least 2 tabs as children of a &#x3C;[role="tablist"]> element are needed. Each tab must reference a unique id of a &#x3C;[role="tabpanel"]> element.'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    ),</span></span>
<span class="line"><span style="color:#F8F8F2">    panels: </span><span style="color:#A6E22E">all</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">      '[role="tabpanel"]'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E6DB74">      'At least 2 tabpanels are needed. Each tabpanel must have a unique id.'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    ),</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#FD971F;font-style:italic">  ui</span><span style="color:#66D9EF;font-style:italic"> =></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#88846F">    // Component setup</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><p>The <code>first()</code> function expects the matched element to be present at connection time. If not, it will silently ignore the call.</p><p>On the other hand, the <code>all()</code> function returns a <code>Memo&lt;E[]&gt;</code> ‚Äî a memoized, reactive signal of all elements matching the selector. Call <code>.get()</code> to unwrap the current array of elements. Because it's memoized, unwrapping it multiple times is almost free. And because it's reactive, effects that read from it automatically re-run whenever elements are added, removed, or rearranged in the DOM.</p><p>Under the hood, a lazy <code>MutationObserver</code> watches for structural changes and invalidates the memo when needed. Le Truc then diffs the new element list against the previous one, applies effects to newly added elements, and runs cleanup functions on removed ones.</p><card-callout class="tip"><p><strong>Tip</strong>: <code>all()</code> sets up a <code>MutationObserver</code> and re-runs effects on every structural change. Prefer <code>first()</code> when targeting a single element known to be present at connection time.</p></card-callout></section><section><h2 id="adding-event-listeners"><a name="adding-event-listeners" class="anchor" href="#adding-event-listeners"><span class="permalink">üîó</span><span class="title">Adding Event Listeners</span></a></h2><p>Event listeners respond to user interactions. They are the main cause for changes in component state. Le Truc provides two approaches for handling events, each suited to different situations.</p><h3 id="on-imperative-event-handling"><a name="on-imperative-event-handling" class="anchor" href="#on-imperative-event-handling"><span class="permalink">üîó</span><span class="title">on() ‚Äî Imperative Event Handling</span></a></h3><p>The <code>on()</code> effect works like a familiar <code>addEventListener()</code> callback. It receives the DOM event and lets you imperatively update host properties:</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!" collapsed=""><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'my-component'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {</span></span>
<span class="line"><span style="color:#F8F8F2">    active: </span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    value: </span><span style="color:#E6DB74">''</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">all</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">first</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#F8F8F2">    buttons: </span><span style="color:#A6E22E">all</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'button'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">    input: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'input'</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">host</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">input</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#F8F8F2">    buttons: </span><span style="color:#A6E22E">on</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'click'</span><span style="color:#F8F8F2">, ({ </span><span style="color:#FD971F;font-style:italic">target</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#88846F">      // Set 'active' signal to value of data-index attribute of button</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">      const</span><span style="color:#F8F8F2"> index </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> parseInt</span><span style="color:#F8F8F2">(target.dataset.index, </span><span style="color:#AE81FF">10</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">      host.active </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> Number.</span><span style="color:#A6E22E">isInteger</span><span style="color:#F8F8F2">(index) </span><span style="color:#F92672">?</span><span style="color:#F8F8F2"> index </span><span style="color:#F92672">:</span><span style="color:#AE81FF"> 0</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">    }),</span></span>
<span class="line"><span style="color:#F8F8F2">    input: </span><span style="color:#A6E22E">on</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'change'</span><span style="color:#F8F8F2">, () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#88846F">      // Set 'value' signal to value of input element</span></span>
<span class="line"><span style="color:#F8F8F2">      host.value </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> input.value;</span></span>
<span class="line"><span style="color:#F8F8F2">    }),</span></span>
<span class="line"><span style="color:#F8F8F2">  })</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><p>The handler can also <strong>return an object</strong> to update multiple host properties at once. When it does, the updates are automatically batched for efficiency:</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">on</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'click'</span><span style="color:#F8F8F2">, () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#F8F8F2">  count: host.count </span><span style="color:#F92672">+</span><span style="color:#AE81FF"> 1</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  lastClicked: Date.</span><span style="color:#A6E22E">now</span><span style="color:#F8F8F2">(),</span></span>
<span class="line"><span style="color:#F8F8F2">}))</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button></module-codeblock><p>Since <code>on()</code> is an effect, it's attached to a specific UI element and automatically cleaned up when the component disconnects.</p><h3 id="createeventssensor-declarative-event-to-state-mapping"><a name="createeventssensor-declarative-event-to-state-mapping" class="anchor" href="#createeventssensor-declarative-event-to-state-mapping"><span class="permalink">üîó</span><span class="title">createEventsSensor() ‚Äî Declarative Event-to-State Mapping</span></a></h3><p>For more complex event handling, <code>createEventsSensor()</code> takes a different approach: instead of imperatively mutating state, it <strong>derives a single reactive value</strong> from one or more event types. This value becomes a read-only property on the component.</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!" collapsed=""><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'module-tabgroup'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {</span></span>
<span class="line"><span style="color:#88846F">    // 'selected' is a read-only property derived entirely from events</span></span>
<span class="line"><span style="color:#F8F8F2">    selected: </span><span style="color:#A6E22E">createEventsSensor</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#A6E22E">      read</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">ui</span><span style="color:#66D9EF;font-style:italic"> =></span><span style="color:#A6E22E"> getSelected</span><span style="color:#F8F8F2">(ui.tabs.</span><span style="color:#A6E22E">get</span><span style="color:#F8F8F2">(), isSelectedTab), </span><span style="color:#E6DB74">''</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#E6DB74">      'tabs'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">      {</span></span>
<span class="line"><span style="color:#A6E22E">        click</span><span style="color:#F8F8F2">: ({ </span><span style="color:#FD971F;font-style:italic">target</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#A6E22E"> getAriaControls</span><span style="color:#F8F8F2">(target),</span></span>
<span class="line"><span style="color:#A6E22E">        keyup</span><span style="color:#F8F8F2">: ({ </span><span style="color:#FD971F;font-style:italic">event</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">ui</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">target</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">prev</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#88846F">          // Handle arrow key navigation</span></span>
<span class="line"><span style="color:#F92672">          if</span><span style="color:#F8F8F2"> ([</span><span style="color:#E6DB74">'ArrowLeft'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'ArrowRight'</span><span style="color:#F8F8F2">].</span><span style="color:#A6E22E">includes</span><span style="color:#F8F8F2">(event.key)) {</span></span>
<span class="line"><span style="color:#F92672">            return</span><span style="color:#A6E22E"> getNextTab</span><span style="color:#F8F8F2">(ui.tabs.</span><span style="color:#A6E22E">get</span><span style="color:#F8F8F2">(), target, event.key)</span></span>
<span class="line"><span style="color:#F8F8F2">          }</span></span>
<span class="line"><span style="color:#F8F8F2">        },</span></span>
<span class="line"><span style="color:#F8F8F2">      },</span></span>
<span class="line"><span style="color:#F8F8F2">    ),</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#88846F">  // ...</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><p>The sensor handler receives a rich context object with typed access to:</p><ul><li><strong><code>event</code></strong> ‚Äî the original DOM event</li><li><strong><code>target</code></strong> ‚Äî the matched element (with proper type information, unlike <code>event.target</code>)</li><li><strong><code>ui</code></strong> ‚Äî the full component UI object</li><li><strong><code>prev</code></strong> ‚Äî the previous value of the sensor</li></ul><p>The sensor is created as a <strong>property initializer</strong> (second parameter of <code>defineComponent</code>), not as an effect. This means the resulting property is read-only ‚Äî no other code can write to it. The sensor is the sole source of truth for that value.</p><h3 id="when-to-use-which"><a name="when-to-use-which" class="anchor" href="#when-to-use-which"><span class="permalink">üîó</span><span class="title">When to Use Which?</span></a></h3><card-callout class="tip"><p><strong>Choosing the right approach</strong></p><p>Use <strong><code>on()</code></strong> when you want to:</p><ul><li>React to a single event type on an element</li><li>Imperatively update one or more host properties</li><li>Keep the handler simple and familiar</li></ul><p>Use <strong><code>createEventsSensor()</code></strong> when you want to:</p><ul><li>Derive a single value from multiple event types (click, keyboard, etc.)</li><li>Ensure the property is read-only ‚Äî only events can change it</li><li>Access the previous value, typed target element, or component UI in the handler</li></ul><p><strong>Rule of thumb</strong>: If you're <em>doing things</em> in response to an event, use <code>on()</code>. If an event stream <em>is</em> the state, use <code>createEventsSensor()</code>.</p></card-callout></section><section><h2 id="synchronizing-state-with-effects"><a name="synchronizing-state-with-effects" class="anchor" href="#synchronizing-state-with-effects"><span class="permalink">üîó</span><span class="title">Synchronizing State with Effects</span></a></h2><p>Effects <strong>automatically update the DOM</strong> when signals change, avoiding manual DOM manipulation.</p><h3 id="applying-effects"><a name="applying-effects" class="anchor" href="#applying-effects"><span class="permalink">üîó</span><span class="title">Applying Effects</span></a></h3><p>Apply one or multiple effects in the setup function (for component itself) or in element selector functions:</p><module-codeblock language="js" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#F92672">return</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#88846F">  // On the component itself</span></span>
<span class="line"><span style="color:#F8F8F2">  host: </span><span style="color:#A6E22E">setAttribute</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'open'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'open'</span><span style="color:#F8F8F2">), </span><span style="color:#88846F">// Set 'open' attribute according to 'open' signal</span></span>
<span class="line"><span style="color:#88846F">  // On element for the 'count' property of the UI object</span></span>
<span class="line"><span style="color:#F8F8F2">  count: [</span></span>
<span class="line"><span style="color:#A6E22E">    setText</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'count'</span><span style="color:#F8F8F2">), </span><span style="color:#88846F">// Update text content according to 'count' signal</span></span>
<span class="line"><span style="color:#A6E22E">    toggleClass</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'even'</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">'isEven'</span><span style="color:#F8F8F2">) </span><span style="color:#88846F">// Toggle 'even' class according to 'isEven' signal</span></span>
<span class="line"><span style="color:#F8F8F2">  ]</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button></module-codeblock><p>The order of effects is not important. Feel free to apply them in any order that suits your needs.</p><h3 id="bundled-effects"><a name="bundled-effects" class="anchor" href="#bundled-effects"><span class="title">Bundled Effects</span><span class="permalink">#</span></a></h3><p>Le Truc provides many built-in effects for common DOM operations. See the  in the API reference for detailed descriptions and usage examples.</p><h3 id="simplifying-effect-notation"><a name="simplifying-effect-notation" class="anchor" href="#simplifying-effect-notation"><span class="title">Simplifying Effect Notation</span><span class="permalink">#</span></a></h3><p>For effects that take two arguments, <strong>the second argument can be omitted</strong> if the signal key matches the targeted property name, attribute, class, or style property.</p><p>The following are equivalent:</p><module-codeblock language="js"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#88846F">// setAttribute('open', 'open')</span></span>
<span class="line"><span style="color:#A6E22E">setAttribute</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'open'</span><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button></module-codeblock><p>Here, <code>setAttribute('open')</code> automatically uses the <code>open</code> signal.</p><h3 id="using-local-signals-for-private-state"><a name="using-local-signals-for-private-state" class="anchor" href="#using-local-signals-for-private-state"><span class="title">Using Local Signals for Private State</span><span class="permalink">#</span></a></h3><p>Local signals are useful for storing state that should not be exposed to the outside world. They can be used to manage internal state within a component:</p><module-codeblock language="js" collapsed="true"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'my-component'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {},</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">first</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#F8F8F2">    increment: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'button.increment'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">    count: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'.count'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">    double: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'.double'</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#F8F8F2">  () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    const</span><span style="color:#F8F8F2"> count </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> createState</span><span style="color:#F8F8F2">(</span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">    const</span><span style="color:#F8F8F2"> double </span><span style="color:#F92672">=</span><span style="color:#A6E22E"> createMemo</span><span style="color:#F8F8F2">(() </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> count.</span><span style="color:#A6E22E">get</span><span style="color:#F8F8F2">() </span><span style="color:#F92672">*</span><span style="color:#AE81FF"> 2</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">      increment: </span><span style="color:#A6E22E">on</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'click'</span><span style="color:#F8F8F2">, () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">        count.</span><span style="color:#A6E22E">update</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">v</span><span style="color:#66D9EF;font-style:italic"> =></span><span style="color:#F92672"> ++</span><span style="color:#F8F8F2">v)</span></span>
<span class="line"><span style="color:#F8F8F2">      }),</span></span>
<span class="line"><span style="color:#F8F8F2">      count: </span><span style="color:#A6E22E">setText</span><span style="color:#F8F8F2">(count),</span></span>
<span class="line"><span style="color:#F8F8F2">      double: </span><span style="color:#A6E22E">setText</span><span style="color:#F8F8F2">(double),</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><p>Outside components cannot access the <code>count</code> or <code>double</code> signals.</p><h3 id="using-functions-for-ad-hoc-derived-state"><a name="using-functions-for-ad-hoc-derived-state" class="anchor" href="#using-functions-for-ad-hoc-derived-state"><span class="title">Using Functions for Ad-hoc Derived State</span><span class="permalink">#</span></a></h3><p>Instead of a signal key or a local signal, you can <strong>pass a function</strong> that derives a value dynamically:</p><module-codeblock language="js" collapsed="true"><p class="meta"><span class="language">js</span></p><pre class="shiki monokai" style="background-color:#272822;color:#F8F8F2" tabindex="0"><code><span class="line"><span style="color:#A6E22E">defineComponent</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E6DB74">  'my-component'</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  {</span></span>
<span class="line"><span style="color:#F8F8F2">    count: </span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">first</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#F8F8F2">    count: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'.count'</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">    double: </span><span style="color:#A6E22E">first</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'.double'</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">  }),</span></span>
<span class="line"><span style="color:#F8F8F2">  ({ </span><span style="color:#FD971F;font-style:italic">host</span><span style="color:#F8F8F2"> }) </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F8F8F2"> ({</span></span>
<span class="line"><span style="color:#F8F8F2">    count: </span><span style="color:#A6E22E">toggleClass</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'even'</span><span style="color:#F8F8F2">, () </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#F92672"> !</span><span style="color:#F8F8F2">(host.count </span><span style="color:#F92672">%</span><span style="color:#AE81FF"> 2</span><span style="color:#F8F8F2">)),</span></span>
<span class="line"><span style="color:#F8F8F2">    double: </span><span style="color:#A6E22E">setText</span><span style="color:#F8F8F2">(() </span><span style="color:#66D9EF;font-style:italic">=></span><span style="color:#A6E22E"> String</span><span style="color:#F8F8F2">(host.count </span><span style="color:#F92672">*</span><span style="color:#AE81FF"> 2</span><span style="color:#F8F8F2">))</span></span>
<span class="line"><span style="color:#F8F8F2">  })</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span></code></pre><basic-button class="copy" copy-success="Copied!" copy-error="Error trying to copy to clipboard!"><button type="button" class="secondary small"><span class="label">Copy</span></button></basic-button><button type="button" class="overlay" aria-expanded="false">Expand</button></module-codeblock><card-callout class="tip"><p><strong>When to use</strong></p><ul><li><strong>Use a signal key or a local signal</strong> when the state is part of the component's public interface or internally reused.</li><li><strong>Use a function</strong> to <strong>derive a value on the fly</strong> when it is needed only in this one place.</li></ul><p>Ad-hoc derived state is more efficient than the overhead of a memoized computed signal for simple functions like converting to a string or boolean, formatting a value or performing a calculation.</p></card-callout><h3 id="efficient-fine-grained-updates"><a name="efficient-fine-grained-updates" class="anchor" href="#efficient-fine-grained-updates"><span class="title">Efficient &amp; Fine-Grained Updates</span><span class="permalink">#</span></a></h3><p>Unlike some frameworks that <strong>re-render entire components</strong>, Le Truc updates only what changes:</p><ul><li><strong>No virtual DOM</strong> ‚Äì Le Truc modifies the DOM directly.</li><li><strong>Signals propagate automatically</strong> ‚Äì no need to track dependencies manually.</li><li><strong>Optimized with a scheduler</strong> ‚Äì multiple updates are batched efficiently.</li></ul></section></main>

			<footer class="content-grid">
				<div class="content">
					<h2 class="visually-hidden">Footer</h2>
					<p>¬© 2024 ‚Äì 2026 Zeix AG</p>
				</div>
			</footer>
		</context-router>
	</body>
</html>
